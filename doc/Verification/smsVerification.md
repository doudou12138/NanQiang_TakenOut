# 用户验证码登录功能实现

## 请求验证码
1. 后端接收到请求验证码的请求
2. 到redis中获得当前小时验证码的请求次数，并加一。（每小时限制3次）
   - 如果达到最大请求次数,则返回业务错误信息
   - 如果没有达到，则系统生成验证码，并存到缓存中；调用阿里云sms发送短信
   > 如果上次的验证码还没有删除，则覆盖它  
   > 设置过期时间（也是验证码的有效时间）

## 验证 验证码：
1. 接收到前端传来的验证码和号码
2. 到redis中get验证码并与之相比较。验证码get后则删除，防止被多次使用。

### 细节：
#### 为什么要限制验证次数：
防止恶意攻击，造成性能不必要的损失；同时阿里云sms也不是免费的，防止成本增加。
#### 缓存数据清理：
请求次数数据：过期时间1小时，（验证每小时3次的功能是在key上加小时时间戳）    
验证码数据：过期时间3分种，  

## 待解决问题:
由于这些数据都没有放到数据库中,只会在redis中存储, 所以如果redis宕机了,
这些数据就丢失了,所以需要一个定时任务,每隔一段时间,把redis中的数据同步到数据库中.
或者通过哨兵机制,保证其可用性.